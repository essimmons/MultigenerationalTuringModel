# A multigenerational Turing model reproduces transgressive petal spot phenotypes in hybrid *Mimulus*: Supplementary Material

Emily S. G. Simmons, Arielle M. Cooley, Joshua R. Puzey, and Gregory D. Conradi Smith

## Description
The code included in this project reproduces simulations for a population of F2 hybrids from the article [A multigenerational Turing model reproduces transgressive petal spot phenotypes in hybrid *Mimulus*](https://link.springer.com/article/10.1007/s11538-023-01223-7), published in the Bulletin of Mathematical Biology in November, 2023. 

In addition to the Matlab files provided here, interested persons can also explore the simulations through [VisualPDE](https://visualpde.com/). Using VisualPDE, we have replicated replicated the full 4-variable PDE system and the reduced 2-variable system. The [4-variable model](https://visualpde.com/sim/?options=N4IghiBcAuBOCuBTANCARgVSiAdo+AtmDjiKmgGrZ6HGnkDq1+RJZ6Ais7W+RJOAAmg9mljYATAAZRAN0kzUAYzRQ4SVIIxYBUgHQBGdoIpVdh4wyYCDAFmMcuN+5oDO2W1MUhB0KPoBWZR0QA28lM1C9ADZ2JWsQfQB2ALinKIAOdgBrbDAAfXgDAF59Ly8JDIBuNEKSsqkDaoBzOuKDQ2loquy6otK9AGYAlJ6+iQHh0d6i2RKAThj5+dsx2YnF6OXVgvgJhql5gIl5pJrC-b0vW3mq1r2BjIMDQbWJfv0JWwyzmffLr4-N5zYpJPQBeYGCTAiZgiFQqoFEEHL5hM61ZFXKTRM6tTFSDI3MZzD6GAIZW69EmXAzkyn5OYgjqDKSeYkGWQTZmsqSIhmXLwIjECwaDW54y4s47E971QzRQbQqn-AYGBVK-mYyoSAwyzkDbW69hEKCePQrTxJaIBQYZAkQ2yoAgASygHReAS21pZg1sOqkElQpAELlwABVTV5UAAHbAAYXgrmgAHsCOxYCFdgYALS1IoAKiKAGp7gZ8wAKcszAwF4vVvaFiQASgA9OWDEX62W6+NG526nN83N++sh82mwA9CTpyK7CS5i59+4SCtVi61jt-Bt7Vvtkeywub9crvb7wfDv6csdNyfT1CwBJInMYsvDvFlytUmvdo-Uxu739v0Pfs-1PL9z0Aq9ORvKd03SJF52FMcS35VdlQ3ED-n-NtfwPHtOW3CRMIg4iV2g292FcWMBFSVBXGDEAigAAj2Ji5jYu8QFcABHNQEBQEBoBEGB+NQaB3AEAAlABpUN5EgABtUAwFgWBkwAdzjZMABtk3gcRIGtG0gnAVSNIAEUQHBXGdaAAE9-HBVAVLU9SABkrOaaAAAsAFkwAAD2wIxnLM9SAGUlDAbTEDyeAU3YFyNIADWwNz8gClsJCY7MmKC0LXIATTS-I7KynKmIc5z4uTcLEGgLTdP0yTiGaWKRI0EAooIRBYDAMNvPq-gWWUMAer6gAFbzXUgEaurG3qwAALWTVNHIyZQdL02AiGowT9LQZM4i2g6VL4zqlGTHAU30iSADNotcATLuu7bGu2-xNte-SAFFoxs3TgzKAwvpu2AADlCCgEylETFMCHC-SHqUdqHu0p7UEQAhDtce7HoErGcdcABBbHnSsvxIECTHseTXHzOdO67sTdr9GiGmiammaOhGAkObp1xwumnAHMgMJ+dx8KCFWny8FxxzAxAQmBfC6NEFh7SzqpvRFeV3GBqGxykgyAJHRAO7tOdaM1cEd79N2qA0YxkBLbwBhnV8Pz4G0t0nUCu3YAoaKkEcgwkidZ0cADoPtJD7XaVQZNZF6zXRadgSk5TsA7IDz6QEz2BU7+gGrscrwTILouAujAzQnYSvs7cyPEHdz3fO932QGjXToDDOy1ewbviFiuikbAFGADF4AY7wfNgRBEHMgAJRBnWabzoEi6LWb0cOQGTpQU1gCfye04T09QdTvLAXvkwmnvsGLPZ2BwBbgpAABfABdS-hMYkKQDqT2k-acH8gA) reproduces the F1 hybrid simulations in Figure 4 of the paper. The [2-variable reduced model](https://visualpde.com/sim/?options=N4IghiBcAuBOCuBTANCARgVSiAdo+AtmDjiKmgGrZ6HGnmzYCMADGegG7YBMAdN+wDGaKHCSpBAUSgteLFgHYJAOSjcWEgCKiEKEABMMWSCF5N2+ilRMBmAGwWA6o+xtU+gM7YALPIvQZOQBWCWMQPnMJa3DeIPYAa2wwAH14AAI0gF4M2XluAE4AbjRUjOy03JYADgVCgHNSrIymXm9uIKL41PSmit57bjtCrvgOMozvOSYgoZSx3sqWb2Lk+fLctpt61fG+hW4bbmHVnvX+lg7jjjWc-u5pwoJu3dk7OzSASxwMgG0NNKYAF1HicXrF3l9fv8gSDRmCgp9vmk-sgAcCntcwTYFIioaiYewiFAbLF9timPsmIMFEoQAQPlAWnYgkELkFfNiWPlvEwmHZUAAHbAAYXgHmgAHsCOxYAAxKAAMzAABsPHpYGFuAAqFLwAC0JXgWvgAGptQ0jQAKS0jK1ME1PeDwACUxudAHpLdwTbatZb7Y6XcafakOH6A6HXRxnc6AHoCVCwaLauYG1ZajhmrUNMPWrocO0Ok6ul2e735wsYoOm-O5iPXKMx+MylwmNwgDxCkxxVAeUgmdJcXsARx04hA0H0Y700C8JgASgBpbzsLiQH6gMCwWASgDuwolyol8EYkGZQRsIXA273mkQOA8H2gAE9AletzvdwAZe91aAACwAWTAAAPZh2A-PcAGVBBVRAkngSUIJvXcAA1sC-ZIQPdbg0j1NIwNQSDdwATQw5JnxwvC0lfIjEIlKDEGgA8jxPediDqeCYF0CQwAIRBYDAAAVf8mIgSAbA0EBYP4wSAAV-wZCSpJkgSwAALQlKVAiqCRD2PWAiC7CcTzQCUhH00yt2nPScElE85yVVU9EECU7IMliDJkWz7NgSQBUfI9+0qWlXPck9lEINQVLFSUCCgk8lUELinLVVBEAIMyPEclU0pADKso8ABBTKPnvAJIFkK8ColbLNA+BUFTFLjXnSzLao8BSlJaIIFGqNrCqgxScFfSBWAGjqoIILSALwbLAm4CbsqggVEEEeBlWsyr+CWjwRLEwIFCqdlUAVZUPgFVb9E8k8jMVXK9HOvBHA+fQAMAjbGVQIgQJupMVSQRkpPpHA-ooAGWtaaoaRYS9BhYdQLlQCUOAEzbRtSvQUbRsBnz+7yQGx2B0f8wK3MCeQryJkmQIFU8QEiQnUeJ3Gvy+RAXreoDPrGwUj2gITn1W7ABU2vB2A8RKwGS2V4H7EB2wA2BEEQTQAAlEA+Op-2gGC4MO1BUcESU5TK5Up0gTHUF3f8wAFiU5P57B4HYHA+K4hmQAAX0Ba2LZAF3reMl2vaAA) reproduces the F1 hybrid from Figure 6 of the paper. Simulation of Figure 6 parents can also be achieved in the 2-variable model by setting all $m_{**}=1$.

### Included files
- Main file for running simulations.
	- MultigenTuringModel.m
- Supporting function files (listed alphabetically).
	- buildF2Fig.m
    - config.m   
	- findCriticalk2.m
	- findJacobian.m
	- findSteadyState.m
	- implicitRxnDiff2D.m
	- interpretZygosity.m
	- revertFromF1ToGenes.m
	- runF2Simulations.m
- 6 different parameter files titled "FigXXParams.mat" which reproduce the corresponding published figures.
	- Fig04Params.mat
	- Fig5AParams.mat
	- Fig5BParams.mat
	- Fig5CParams.mat
	- Fig5DParams.mat
	- Fig6Params.mat

## Requirements
This project is built on MATLAB_2023a.

## Usage
- Open MatLab
- Load parameters from one of the 6 corresponding parameter files, or make your own.
	- If making your own parameter set, reference one of the parameter sets provided for formatting.
- Set up your simulation configurations in `config.m`
	- `configs.N`: the number of mesh points, $N$, you wish to use in your simulation.
	    - To reproduce the figures as they appear in the paper, choose `configs.N=100`.
	- `configs.axisSize`: Choose the spatial domain as multiples of the anticipated F1 wavelength, $\omega$.
	- `configs.makeF2Fig`: Choose whether or not you want to build and save the figure. 
		- If yes, set `configs.makeF2Fig=1`. 
		- If no, set `configs.makeF2Fig=0`.
	- `configs.showProgress`: Choose whether or not you want to see the progression of the simulations as they are calculated.
		- If yes, set `configs.showProgress=1`.
		- If no, set `configs.showProgress=0`.
- Run the file `MultigenTuringModel.m`.
- When complete, the program will save the steady-state activator concentration results of all 12 simulations as
		"UdataSz"+ `N` + ".mat"
		"UdataSz"+ `N` + ".dat"
	- If you opted to build the figure, the figure will be saved as 
		  "F2SimulationSz" +  `N`  + ".fig"
